**Implementačná dokumentácia k 2. úlohe do IPP 2021/2022**
**Meno a priezvisko**: Adam Zvara
**Login**: xzvara01

## interpret.py

Spracovanie argumentov príkazovej riadky zapezpečuje trieda **InputSource**, ktorá poskytuje metódy na získanie interpretovaného programu (*get_source()*) a metódu na získanie vstupu od užívateľa (*get_input_line()*). Jednu z hlavných častí interprétu tvorí práca s načítanými inštrukciami, na ktorú slúži trieda **XML_representation**.
Cieľom prvej časti interprétu je prevedenie načítaných inštrukcií s ich argumentami v XML formáte do objektov triedy **Instruction**, ktoré sú následovne uložené v objekte triedy **Program**, ktorý predstavuje hlavnú časť interpretácie. Táto trieda obsahuje atribúty používané pri interpretácií (zoznam načítaných inštrukcií, pozíciu aktuálne vykonávanej inštrukcie ...) a samotné metódy interpretujúce inštrukcie. Po načítaní všetkých inštrukcií, ich zoradení podľa poradia a získania pozícií návestí začína samotná interpretácia, ktorá spočíva v zavolaní príslušných metód realizujúcih interpretáciu.
Jeden z problémov vykonávania inštrukcií boli inštrukcie skoku a návratu - tie sú realizované pomocou *call_stack*u (zoznam, do ktorého sa ukladá poradie poslednej inštrukcie skoku). Samotné skoky teda nie je ťažké implementovať, keďže si *program* uchováva inštrukcie v zozname a taktiež má uloženú informáciu o naposledy vykonanej inštrukcii. Pri návrate je získaný posledný index vykonávanej inštrukcie pred skokom, od ktorého pokračuje interpretácia.
Ďalší z problémov prestavovalo ukladanie premenných a rámcov. To je rozdelené do separátnej triedy **Variable_manager**, ktorého inštancia je uložená v *program*e. Táto trieda poskytuje metódy na prácu s premennými a rámcami. Aktuálne platné rámce sú uložené v slovníku, kde kľuče predstavujú názvy jednotlivých rámcov (GF, TF, LF) a hodnoty sú zoznamy obsahujúce objekty triedy **Variable**. O premmenných sú uložené základné informácie ako názov rámca, do ktorého patria, názov premennej, typ a hodnota. Na ukladanie lokálnych rámcov je opäť využitý zásobník, do ktorého sa vkladá celý obsah aktuálneho lokálneho rámcu (po inštrukcii PUSHFRAME).

## test.php

Skript **test.php** je rozdelený do niekoľkých logických častí.
Prvou časťou je trieda **Context**, ktorá zabezpečuje spracovanie parametrov získaných pri spustení skriptu. Parametre sú spracované pomocou funkcie *getopt* a následne je skontrolovaná ich integrita v konštruktore samotnej triedy (existencia súborov a adresárov, konflikty parametrov).
Po spracovaní parametrov sa začína samotné testovanie. Na prehľadávanie adresárov s testovacími súbormi slúži trieda **DirectorySearch**, ktorá poskytuje metódu ***get_file()***, ktorá vráti cestu k následujúcemu testovaciemu súboru (s príponou '.src'). Vnútorne trieda využíva *RecursiveDirectoryIterator* a *RecursiveIteratorIterator*, ktoré rekurzívne prehľadávajú zadaný adresár (rekurzívne prehľadávanie sa dá obmedziť metódou *setMaxDepth()*). Následne pomocou *while* cyklu získavám súbory na testovanie. Na základe zvolených parametrov *--int-only*, *--parse-only* sa volá metóda *test()* konkrétneho testovacieho modulu.
Existujú 3 testovacie moduly: **ParseTester**, **InterpretTester** a **MultiTester**. Abstraktná trieda **Tester** poskytuje všetkým zdedeným triedam názvy interprétov na spustenie (php8.1, python3) a zaručuje implementáciu metódy *test()* v jej potomkoch. Z nej zdedené triedy **SingleTester** a **MultiTester** obsahujú implementáciu metódy *test()*. Z triedy **SingleTester** dedia triedy *ParseTester* a *InterpretTester*.
Všetky implementácie metódy *test()* vytvárajú dočasné súbory v adresári aktuálne spusteného testu. Návratové hodnoty tejto funkcie sú *true* v prípade, že test uspeje, v opačnom prípade *false*. Individuálne testovaie parseru alebo interpretu vytvára jeden dočasný súbor s názvom aktuálne spusteného testu a príponou *.tmp*. Testovanie oboch častí zároveň vytvára 2 dočasné súbory, ktorých názov je zložený z názvu tesu a prípon *.parse* (vytvorení po parsovaní) *.int* (vytvorený po interpretácii), aby bolo možné ručne skontrolovať výsledky po parsovaní a interpretácií.
Návratové hodnoty funkcie *test()* sa využívajú pri rozdelení testov na úspešné a neúspešné. Pole *allTests* slúži na uloženie mien adresárov, ktorých testy boli spustené. V 2D poliach *testsPassed* a *testsFailed* sú na prvej úrovni uložené názvy jednotlivých adresárov spustených testov a na druhej úrovni sú mená konkrétných testov ktoré (ne)prešli.
Informácie o jednotlivých testoch sú ďalej použité v triede **HTMLCreator**, ktorá vytvára výsledný HTML dokument. Na jeho vytvorenie je použitá trieda *DOMImplementation*. Testované adresáre sú vypísané podľa abecedného poradia a jednotlivé testy sú zoradené podľa toho, či boli neúspešné (tie sú zobrazované ako prvé) alebo úspešné.